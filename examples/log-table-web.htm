<!doctype html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
        <title>Log Table Demo | Web Components</title>
        <link rel="stylesheet" href="css/log-table.css">
        <link rel="canonical" href="https://www.dataformsjs.com/examples/log-table-hbs.htm">
    </head>
    <body>
        <div id="view" class="pt10"></div>

        <url-router view-selector="#view">
            <url-route path="/" redirect="/10"></url-route>
            <url-route path="/:count">
                <template>
                    <json-data url="https://www.dataformsjs.com/data/example/log-table/:count?format=list" url-params>
                        <is-loading>
                            <h3 class="loading">Loading...</h3>
                        </is-loading>
                        <has-error>
                            <h3 class="error" data-bind="errorMessage"></h3>
                        </has-error>
                        <is-loaded>
                            <div class="flex pt10">
                                <h2></h2>
                                <button data-filter-clear-all>Clear Filter</button>
                            </div>
                
                            <nav>
                                <a href="#/10">10 Records</a>
                                <a href="#/100">100 Records</a>
                                <a href="#/200">200 Records</a>
                                <a href="#/error">Error Example</a>
                            </nav>
                
                            <div>
                                <input type="text" class="large form-control medium-margin-right"
                                    data-filter-selector="table"
                                    data-filter-results-text-selector="h2"
                                    data-filter-results-text-all="{totalCount} Log Example Records"
                                    data-filter-results-text-filtered="Showing {displayCount} of {totalCount} Log Example Records"
                                    data-filter-class-odd="row-odd"
                                    data-filter-class-even="row-even"
                                    placeholder="Enter Filter">
                
                                <button type="button" data-export-csv-selector="table" data-export-file-name="Log-Report.csv">Export to CSV</button>
                            </div>
                
                            <div class="highlighter" style="display:none;">                                
                                <ul>
                                    <li class="info">Click or Tap to Filter</li>
                                    <li class="log-error"
                                        data-highlight-selector="table tbody tr td:nth-child(1)"
                                        data-highlight-value="ERROR"
                                        data-highlight-operator="==="
                                        data-highlight-class="log-error"
                                        data-filter-selector="table"
                                        data-filter-column="Log Level"
                                        data-filter-operator="==="
                                        data-filter-value="ERROR"></li>
                                    <li class="log-warning"
                                        data-highlight-selector="table tbody tr td:nth-child(1)"
                                        data-highlight-value="WARNING"
                                        data-highlight-operator="==="
                                        data-highlight-class="log-warning"
                                        data-filter-selector="table"
                                        data-filter-column="Log Level"
                                        data-filter-operator="==="
                                        data-filter-value="WARNING"></li>
                                </ul>
                            </div>
                            <data-table
                                data-bind="records"
                                table-attr="class=click-to-highlight,
                                            data-sort,
                                            data-sort-class-odd=row-odd,
                                            data-sort-class-even=row-even">
                            </data-table>
                        </is-loaded>
                    </json-data>
                </template>
            </url-route>
        </url-router>

        <!-- DataFormsJS Web Components -->
        <script type="module" src="../js/web-components/url-router.js"></script>
        <script type="module" src="../js/web-components/json-data.js"></script>
        <script type="module" src="../js/web-components/data-table.js"></script>
        <script nomodule src="../js/web-components/polyfill.js"></script>

        <!-- <script src="../js/web-components/polyfill.js"></script> -->

        <!-- DataFormsJS Standard Plugins -->
        <script src="../js/web-components/jsPlugins.js"></script>
        <script src="../js/plugins/filter.js"></script>
        <script src="../js/plugins/sort.js"></script>
        <script src="../js/plugins/highlighter.js"></script>
        <script src="../js/plugins/clickToHighlight.js"></script>
        <script src="../js/plugins/exportToCsv.js"></script>
        <script src="../js/plugins/navLinks.js"></script>

        <!--
            Modern Browsers
            Refresh Plugins after page content is ready (each URL #hash change)
        -->
        <script type="module">
           document.addEventListener('app:contentReady', () => {
               app.refreshPlugins();
           });
       </script>

        <!--
            Old Browsers (IE, old Safari, etc) will use <script nomodule>
            and check if a polyfill is needed for CSS Variables.
        -->
        <script nomodule>
            (function() {
                'use strict';

                // Add CSS Variable Support to IE and older Browsers (only call this once)
                var checkedPolyfill = false;
                function addCssPolyfill() {
                    if (checkedPolyfill) {
                        return;
                    }
                    checkedPolyfill = true;
                    var supportsCssVars = (window.CSS && window.CSS.supports && window.CSS.supports('(--a: 0)'));
                    var polyfillUrl = 'https://cdn.jsdelivr.net/npm/css-vars-ponyfill@2.1.1/dist/css-vars-ponyfill.min.js';
                    app.loadScript(supportsCssVars, polyfillUrl, function() {
                        if (window.cssVars) {
                            cssVars({ include:'link[rel="stylesheet"]' });
                        }
                    });
                }

                // Refresh Plugins after page content is ready (each URL #hash change)
                document.addEventListener('app:contentReady', function() {
                    addCssPolyfill();
                    app.refreshPlugins();
                });
            })();
        </script>
    </body>
</html>
