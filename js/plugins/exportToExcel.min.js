!function(){"use strict";var b={isNumeric:function(e){return!isNaN(e)&&isFinite(e)&&!(1<e.length&&"0"===e.substring(0,1))},excelValue:function(e){if(""===e)return null;if(b.isNumeric(e))return parseFloat(e);var t=new Date(e);return!isNaN(t.getTime())&&0<t.getYear()&&(e.includes("-")||e.includes(",")||e.includes("/"))?t:e},downloadExcelJS:function(e){var t;void 0===window.ExcelJS?((t=document.createElement("script")).src="https://cdn.jsdelivr.net/npm/exceljs@4.3.0/dist/exceljs.min.js",t.onload=e,document.querySelector("head").appendChild(t)):e()},hasInvalidFileNameChars:function(e){for(var t=['"',"<",">","|",":","*","?","\\","/"],n=0;n<t.length;n++)if(e.includes(t[n]))return!0;for(var r=0;r<32;r++)if(e.includes(String.fromCharCode(r)))return!0;return!1},exportTable:function(v){var x="data-running-export";null===v.getAttribute(x)&&(v.setAttribute(x,""),"BUTTON"===v.nodeName&&(v.disabled=!0),b.downloadExcelJS(function(){var e=v.getAttribute("data-export-excel-selector");if((n=v.getAttribute("data-export-file-name"))&&(n.length<=5||!n.endsWith(".xlsx")||b.hasInvalidFileNameChars(n)))app.showErrorAlert("Attribute [data-export-file-name] must be a valid name with file type [*.xlsx]");else{for(var n=n||"Report.xlsx",u=v.getAttribute("data-worksheet-name")||"Report",c=null!==v.getAttribute("data-export-all"),e=document.querySelector(e),t=[],r=[],l=[],o=e.tHead.rows[0],a=0;a<o.cells.length;a++){var h=o.cells[a].textContent,h=(l.push(h),h.length),i=parseInt(Math.max(1.2*h,h+4));r.push(i)}t.push(l);for(var m=e.tBodies[0].rows,p=0,f=m.length;p<f;p++)if(o=m[p],c||"none"!==o.style.display){for(l=[],a=0;a<o.cells.length;a++){var g=o.cells[a],d=g.getAttribute("data-value");i=(d=null===d?g.textContent:d).length,(d=b.excelValue(d))instanceof Date?i=10:"number"==typeof d&&(i=d.toString().length+2),r[a]=Math.max(r[a],i),l.push(d)}t.push(l)}var e=new ExcelJS.Workbook,s=e.addWorksheet(u);for(a=0;a<t.length;a++)s.addRow(t[a]);u=s.getRow(1);for(u.fill={type:"pattern",pattern:"solid",fgColor:{argb:"FFF2F2F2"}},u.font={bold:!0},a=0;a<r.length;a++)s.getColumn(a+1).width=Math.min(50,r[a]);s.autoFilter={from:{row:1,column:1},to:{row:t.length,column:r.length}},s.views=[{state:"frozen",ySplit:1}],e.xlsx.writeBuffer().then(function(e){var t,e=new Blob([e],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"});void 0!==navigator.msSaveBlob?navigator.msSaveBlob(e,n):(t=document.createElement("a"),e=URL.createObjectURL(e),t.setAttribute("href",e),t.setAttribute("download",n),t.style.visibility="hidden",document.body.appendChild(t),t.click(),document.body.removeChild(t)),v.removeAttribute(x),"BUTTON"===v.nodeName&&(v.disabled=!1)})}}))},onRendered:function(){var e,t=document.querySelectorAll("[data-export-excel-selector]"),n=!1;0<t.length&&(null===(e=document.querySelector("a"))&&(e=document.createElement("a")),n=void 0!==navigator.msSaveBlob||void 0!==e.download),Array.prototype.forEach.call(t,function(e){n?e.onclick=function(){b.exportTable(e)}:e.style.display="none"})}};app.addPlugin("exportToExcel",b)}();