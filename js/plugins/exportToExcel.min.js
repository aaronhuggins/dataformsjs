!function(){"use strict";var b={isNumeric:function(e){return!isNaN(e)&&isFinite(e)&&!(1<e.length&&"0"===e.substring(0,1))},excelValue:function(e){if(""===e)return null;if(b.isNumeric(e))return parseFloat(e);var t=new Date(e);return!isNaN(t.getTime())&&0<t.getYear()&&(e.includes("-")||e.includes(",")||e.includes("/"))?t:e},downloadExcelJS:function(e){var t;void 0===window.ExcelJS?(-1!==navigator.userAgent.indexOf("Trident/")&&b.polyfill_IE(),(t=document.createElement("script")).src="https://cdn.jsdelivr.net/npm/exceljs@4.3.0/dist/exceljs.min.js",t.onload=e,document.querySelector("head").appendChild(t)):e()},polyfill_IE:function(){var n=window.RegExp;try{new n("a","u")}catch(e){window.RegExp=function(e,t){return"string"==typeof t&&!0===t.includes("u")&&(t="u"===t?void 0:t.replace("u",""),e=(e=e.replace(/\uDC00-\uDBFF/g,"")).replace(/\uDC00-\uDB7F/g,"")),new n(e,t)},window.RegExp.prototype=n}},hasInvalidFileNameChars:function(e){for(var t=['"',"<",">","|",":","*","?","\\","/"],n=0;n<t.length;n++)if(e.includes(t[n]))return!0;for(var r=0;r<32;r++)if(e.includes(String.fromCharCode(r)))return!0;return!1},exportTable:function(v){var x="data-running-export";null===v.getAttribute(x)&&(v.setAttribute(x,""),"BUTTON"===v.nodeName&&(v.disabled=!0),b.downloadExcelJS(function(){var e=v.getAttribute("data-export-excel-selector");if((n=v.getAttribute("data-export-file-name"))&&(n.length<=5||!n.endsWith(".xlsx")||b.hasInvalidFileNameChars(n)))app.showErrorAlert("Attribute [data-export-file-name] must be a valid name with file type [*.xlsx]");else{for(var n=n||"Report.xlsx",c=v.getAttribute("data-worksheet-name")||"Report",s=null!==v.getAttribute("data-export-all"),e=document.querySelector(e),t=[],r=[],o=[],l=e.tHead.rows[0],a=0;a<l.cells.length;a++){var p=l.cells[a].textContent,p=(o.push(p),p.length),i=parseInt(Math.max(1.2*p,p+4));r.push(i)}t.push(o);for(var f=e.tBodies[0].rows,h=0,m=f.length;h<m;h++)if(l=f[h],s||"none"!==l.style.display){for(o=[],a=0;a<l.cells.length;a++){var g=l.cells[a],u=g.getAttribute("data-value");i=(u=null===u?g.textContent:u).length,(u=b.excelValue(u))instanceof Date?i=12:"number"==typeof u&&(i=u.toString().length+2),r[a]=Math.max(r[a],i),o.push(u)}t.push(o)}var e=new ExcelJS.Workbook,d=e.addWorksheet(c);for(a=0;a<t.length;a++)d.addRow(t[a]);c=d.getRow(1);for(c.fill={type:"pattern",pattern:"solid",fgColor:{argb:"FFF2F2F2"}},c.font={bold:!0},a=0;a<r.length;a++)d.getColumn(a+1).width=Math.min(50,r[a]);d.autoFilter={from:{row:1,column:1},to:{row:t.length,column:r.length}},d.views=[{state:"frozen",ySplit:1}],e.xlsx.writeBuffer().then(function(e){var t,e=new Blob([e],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"});void 0!==navigator.msSaveBlob?navigator.msSaveBlob(e,n):(t=document.createElement("a"),e=URL.createObjectURL(e),t.setAttribute("href",e),t.setAttribute("download",n),t.style.visibility="hidden",document.body.appendChild(t),t.click(),document.body.removeChild(t)),v.removeAttribute(x),"BUTTON"===v.nodeName&&(v.disabled=!1)})}}))},onRendered:function(){var e,t=document.querySelectorAll("[data-export-excel-selector]"),n=!1;0<t.length&&(null===(e=document.querySelector("a"))&&(e=document.createElement("a")),n=void 0!==navigator.msSaveBlob||void 0!==e.download),Array.prototype.forEach.call(t,function(e){n?e.onclick=function(){b.exportTable(e)}:e.style.display="none"})}};app.addPlugin("exportToExcel",b)}();