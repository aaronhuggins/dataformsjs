!function(){"use strict";function v(e){return e=0<=(e=e.replace(/"/g,'""')).search(/("|,|\n|:)/g)?'"'+e+'"':e}var r={exportTable:function(e,t){var o,n,r,s,a,u,p,l,c,e=document.querySelector(e),d=[],i=[];for(t=t||"Report.csv",r=(o=e.tHead.rows[n=0]).cells.length;n<r;n++)i.push(v(o.cells[n].textContent));for(d.push(i.join(",")),u=(s=e.tBodies[a=0].rows).length;a<u;a++){for(i=[],n=0,r=(o=s[a]).cells.length;n<r;n++)null===(l=(p=o.cells[n]).getAttribute("data-value"))&&(l=p.textContent),i.push(v(l));d.push(i.join(","))}e=d.join("\r\n"),e=new Blob([e],{type:"text/csv; charset=utf-8;"}),void 0!==navigator.msSaveBlob?navigator.msSaveBlob(e,t):void 0!==(c=document.createElement("a")).download?(e=URL.createObjectURL(e),c.setAttribute("href",e),c.setAttribute("download",t),c.style.visibility="hidden",document.body.appendChild(c),c.click(),document.body.removeChild(c)):app.showErrorAlert("Unable to Export as a CSV File. Try a different browser and if you need help then please contact support.")},onRendered:function(){var e,t=document.querySelectorAll("[data-export-csv-selector]"),n=!1;0<t.length&&(null===(e=document.querySelector("a"))&&(e=document.createElement("a")),n=void 0!==navigator.msSaveBlob||void 0!==e.download),Array.prototype.forEach.call(t,function(e){var t,o;n?(t=e.getAttribute("data-export-csv-selector"),o=e.getAttribute("data-export-file-name"),e.onclick=function(){r.exportTable(t,o)}):e.style.display="none"})}};app.addPlugin("exportToCsv",r)}();