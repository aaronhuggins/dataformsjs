!function(){"use strict";function b(e){return 0<=(e=e.replace(/"/g,'""')).search(/("|,|\n|:)/g)&&(e='"'+e+'"'),e}var r={exportTable:function(e,t){var o,n,r,a,l,c,d,i,s,u,p=document.querySelector(e),v=[],h=[];for(t=t||"Report.csv",n=0,r=(o=p.tHead.rows[0]).cells.length;n<r;n++)h.push(b(o.cells[n].textContent));for(v.push(h.join(",")),l=0,c=(a=p.tBodies[0].rows).length;l<c;l++){for(h=[],n=0,r=(o=a[l]).cells.length;n<r;n++)h.push(b(o.cells[n].textContent));v.push(h.join(","))}d=v.join("\r\n"),i=new Blob([d],{type:"text/csv; charset=utf-8;"}),void 0!==navigator.msSaveBlob?navigator.msSaveBlob(i,t):void 0!==(u=document.createElement("a")).download?(s=URL.createObjectURL(i),u.setAttribute("href",s),u.setAttribute("download",t),u.style.visibility="hidden",document.body.appendChild(u),u.click(),document.body.removeChild(u)):app.showErrorAlert("Unable to Export as a CSV File. Try a different browser and if you need help then please contact support.")},onRendered:function(){var e,t=document.querySelectorAll("[data-export-csv-selector]"),n=!1;0<t.length&&(null===(e=document.querySelector("a"))&&(e=document.createElement("a")),n=void 0!==navigator.msSaveBlob||void 0!==e.download),Array.prototype.forEach.call(t,function(e){var t,o;n?(t=e.getAttribute("data-export-csv-selector"),o=e.getAttribute("data-export-file-name"),e.onclick=function(){r.exportTable(t,o)}):e.style.display="none"})}};app.addPlugin("exportToCsv",r)}();