!function(){"use strict";function u(e){return 0<=(e=e.replace(/"/g,'""')).search(/("|,|\n|:)/g)&&(e='"'+e+'"'),e}var r={exportTable:function(e,t){var o,n,r,a,l,c,d=document.querySelector(e),i=[],s=[];for(t=t||"Report.csv",n=0,r=(o=d.tHead.rows[0]).cells.length;n<r;n++)s.push(u(o.cells[n].textContent));for(i.push(s.join(",")),l=0,c=(a=d.tBodies[0].rows).length;l<c;l++){for(s=[],n=0,r=(o=a[l]).cells.length;n<r;n++)s.push(u(o.cells[n].textContent));i.push(s.join(","))}e=i.join("\r\n"),d=new Blob([e],{type:"text/csv; charset=utf-8;"}),void 0!==navigator.msSaveBlob?navigator.msSaveBlob(d,t):void 0!==(e=document.createElement("a")).download?(d=URL.createObjectURL(d),e.setAttribute("href",d),e.setAttribute("download",t),e.style.visibility="hidden",document.body.appendChild(e),e.click(),document.body.removeChild(e)):app.showErrorAlert("Unable to Export as a CSV File. Try a different browser and if you need help then please contact support.")},onRendered:function(){var e,t=document.querySelectorAll("[data-export-csv-selector]"),n=!1;0<t.length&&(null===(e=document.querySelector("a"))&&(e=document.createElement("a")),n=void 0!==navigator.msSaveBlob||void 0!==e.download),Array.prototype.forEach.call(t,function(e){var t,o;n?(t=e.getAttribute("data-export-csv-selector"),o=e.getAttribute("data-export-file-name"),e.onclick=function(){r.exportTable(t,o)}):e.style.display="none"})}};app.addPlugin("exportToCsv",r)}();