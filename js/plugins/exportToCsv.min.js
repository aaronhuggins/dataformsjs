!function(){"use strict";function v(e){return 0<=(e=e.replace(/"/g,'""')).search(/("|,|\n|:)/g)&&(e='"'+e+'"'),e}var r={exportTable:function(e,t){var o,n,r,a,l,c,d,i,s=document.querySelector(e),u=[],p=[];for(t=t||"Report.csv",n=0,r=(o=s.tHead.rows[0]).cells.length;n<r;n++)p.push(v(o.cells[n].textContent));for(u.push(p.join(",")),l=0,c=(a=s.tBodies[0].rows).length;l<c;l++){for(p=[],n=0,r=(o=a[l]).cells.length;n<r;n++)null===(i=(d=o.cells[n]).getAttribute("data-value"))&&(i=d.textContent),p.push(v(i));u.push(p.join(","))}e=u.join("\r\n"),s=new Blob([e],{type:"text/csv; charset=utf-8;"}),void 0!==navigator.msSaveBlob?navigator.msSaveBlob(s,t):void 0!==(e=document.createElement("a")).download?(s=URL.createObjectURL(s),e.setAttribute("href",s),e.setAttribute("download",t),e.style.visibility="hidden",document.body.appendChild(e),e.click(),document.body.removeChild(e)):app.showErrorAlert("Unable to Export as a CSV File. Try a different browser and if you need help then please contact support.")},onRendered:function(){var e,t=document.querySelectorAll("[data-export-csv-selector]"),n=!1;0<t.length&&(null===(e=document.querySelector("a"))&&(e=document.createElement("a")),n=void 0!==navigator.msSaveBlob||void 0!==e.download),Array.prototype.forEach.call(t,function(e){var t,o;n?(t=e.getAttribute("data-export-csv-selector"),o=e.getAttribute("data-export-file-name"),e.onclick=function(){r.exportTable(t,o)}):e.style.display="none"})}};app.addPlugin("exportToCsv",r)}();