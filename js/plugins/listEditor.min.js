!function(){"use strict";var v={listSelector:function(){return null===app.activeVueModel?"[data-edit-list][data-template-id],[data-edit-list][data-template-url]":"[data-edit-list]"},setuplistEditorControls:function(){var t=this,e=document.querySelectorAll(v.listSelector());Array.prototype.forEach.call(e,function(e){try{t.setuplistEditorControl(e)}catch(t){app.showError(e,t)}})},setuplistEditorControl:function(t){for(var e,a,l,i,r,o,n,d=t.getAttribute("data-edit-list"),u=t.querySelectorAll("[data-list-item]"),p=t.querySelector("[data-add-item]"),c=0,s=u.length;c<s;c++){for(i=0,r=(e=u[c].querySelectorAll('[name^="item-field-"]')).length;i<r;i++)"INPUT"!==(n=e[i].nodeName)&&"TEXTAREA"!==n&&"SELECT"!==n||(e[i].setAttribute("data-array",d),e[i].setAttribute("data-index",c),o=void 0===e[i].oninput?"change":"input","checkbox"!==(n=e[i].type)&&"radio"!==n||(o="change"),e[i].addEventListener(o,v.listItemValueChanged));null!==(l=u[c].querySelector("[data-delete-button]"))&&(l.setAttribute("data-array",d),l.setAttribute("data-index",c),l.addEventListener("click",v.listItemDeleteClick),l.style.cursor="pointer")}null!==p&&null!==(a=p.querySelector("[data-add-button]"))&&(a.setAttribute("data-array",d),a.style.cursor="pointer",a.addEventListener("click",v.listItemAddClick)),void 0!==app.events&&"function"==typeof app.events.dispatch&&app.events.dispatch("listEditor.loadedListEditorControl",t)},getFormFieldValue:function(t){var e,a=t.nodeName,l=t.type,i=t.getAttribute("data-type"),r=null;switch(""===(r="INPUT"===a||"SELECT"===a||"TEXTAREA"===a?"checkbox"===l||"radio"===l?t.checked:t.value:t.textContent.trim())&&(r=null),i){case"int":e=parseInt(r,10),isNaN(e)||(r=e);break;case"float":e=parseFloat(r),isNaN(e)||(r=e)}return r},listItemValueChanged:function(t){var e=t.target,a=e.getAttribute("data-array"),l=e.getAttribute("data-index"),t=e.name.substring(11),e=v.getFormFieldValue(e);app.activeVueModel&&app.activeVueModel[a]?(app.activeVueModel[a][l][t]=e,app.isUsingVue3()&&(app.activeVueModel[a]=app.activeVueModel[a].slice())):app.activeModel[a][l][t]=e},listItemAddClick:function(t){for(var e,a,l=t.target,t=l.getAttribute("data-array"),i=v.getParentControl(l),r={},o=i.querySelector("[data-add-item]").querySelectorAll('[name^="item-field-"]'),n=0,d=o.length;n<d;n++)e=o[n].name.substring(11),a=v.getFormFieldValue(o[n]),r[e]=a;app.activeVueModel&&app.activeVueModel[t]?(app.activeVueModel[t].push(r),app.activeVueModel.$nextTick(function(){v.setuplistEditorControl(i),Array.prototype.forEach.call(o,function(t){var e=t.nodeName,a=t.type,l=t.getAttribute("data-default");"INPUT"!==e&&"SELECT"!==e&&"TEXTAREA"!==e||("checkbox"===a||"radio"===a?t.checked=null!==l&&"true"===l:t.value=null===l?"":l)})})):(app.activeModel[t].push(r),v.reloadListEditorControl(i))},listItemDeleteClick:function(t){var e=t.target,a=e.getAttribute("data-array"),t=parseInt(e.getAttribute("data-index"),10),e=v.getParentControl(e);app.activeVueModel&&app.activeVueModel[a]?app.activeVueModel[a].splice(t,1):(app.activeModel[a].splice(t,1),v.reloadListEditorControl(e))},getParentControl:function(t){var e=t.parentNode;if(null!==app.activeVueModel)for(;null!==e&&null===e.getAttribute("data-edit-list");)e=e.parentNode;else for(;null!==e&&null===e.getAttribute("data-edit-list")&&null===e.getAttribute("data-template-url")&&null===e.getAttribute("data-template-id");)e=e.parentNode;return e},reloadListEditorControl:function(t){app.refreshHtmlControl(t,function(){v.setuplistEditorControl(t)})},validate:function(){var i=void 0!==app.validation&&"function"==typeof app.validation.validateInput?app.validation.validateInput:null;if(null===i)return console.warn("[app.plugins.listEditor.validate()] was called, however no validation function exists."),[];var r=[],t=document.querySelectorAll(v.listSelector());return Array.prototype.forEach.call(t,function(t){var e=1,a=t.querySelectorAll("[data-list-item]"),l=t.getAttribute("data-list-label");Array.prototype.forEach.call(a,function(t){t=t.querySelectorAll('input[name^="item-field-"], select[name^="item-field-"], textarea[name^="item-field-"]');Array.prototype.forEach.call(t,function(t){t=i(t,null,e,l);t&&r.push(t)}),e++})}),r},onRendered:function(){this.setuplistEditorControls()}};app.addPlugin("listEditor",v)}();