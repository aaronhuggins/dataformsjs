!function(){"use strict";var f={listSelector:function(){return"[data-edit-list][data-template-id],[data-edit-list][data-template-url]"},setuplistEditorControls:function(){var t=this,e=document.querySelectorAll(f.listSelector());Array.prototype.forEach.call(e,function(e){try{t.setuplistEditorControl(e)}catch(t){app.showError(e,t)}})},setuplistEditorControl:function(n){for(var t,e,a,l,r,i,o,d=n.getAttribute("data-edit-list"),u=n.querySelectorAll("[data-list-item]"),s=n.querySelector("[data-add-item]"),c=0,p=u.length;c<p;c++){for(l=0,r=(t=u[c].querySelectorAll('[name^="item-field-"]')).length;l<r;l++)"INPUT"!==(i=t[l].nodeName)&&"TEXTAREA"!==i&&"SELECT"!==i||(t[l].setAttribute("data-array",d),t[l].setAttribute("data-index",c),o=void 0===t[l].oninput?"change":"input",t[l].addEventListener(o,f.listItemValueChanged));null!==(a=u[c].querySelector("[data-delete-button]"))&&(a.setAttribute("data-array",d),a.setAttribute("data-index",c),a.addEventListener("click",f.listItemDeleteClick),a.style.cursor="pointer")}null!==s&&null!==(e=s.querySelector("[data-add-button]"))&&(e.style.cursor="pointer",e.addEventListener("click",function(){for(var t,e,a={},l=s.querySelectorAll('[name^="item-field-"]'),r=0,i=l.length;r<i;r++)t=l[r].name.substring(11),e=f.getFormFieldValue(l[r]),a[t]=e;app.activeModel[d].push(a),f.reloadListEditorControl(n)})),void 0!==app.events&&"function"==typeof app.events.dispatch&&app.events.dispatch("listEditor.loadedListEditorControl",n)},getFormFieldValue:function(t){var e,a=t.nodeName,l=t.type,r=t.getAttribute("data-type"),i=null;switch(""===(i="INPUT"===a||"SELECT"===a||"TEXTAREA"===a?"checkbox"===l||"radio"===l?t.checked:t.value:t.textContent.trim())&&(i=null),r){case"int":e=parseInt(i,10),isNaN(e)||(i=e);break;case"float":e=parseFloat(i),isNaN(e)||(i=e)}return i},listItemValueChanged:function(t){var e=t.target,a=e.getAttribute("data-array"),l=e.getAttribute("data-index"),r=e.name.substring(11),i=f.getFormFieldValue(e);app.activeModel[a][l][r]=i},listItemDeleteClick:function(t){var e,a=t.target,l=a.getAttribute("data-array"),r=parseInt(a.getAttribute("data-index"),10);for(app.activeModel[l].splice(r,1),e=a.parentNode;null!==e&&null===e.getAttribute("data-edit-list")&&null===e.getAttribute("data-template-url")&&null===e.getAttribute("data-template-id");)e=e.parentNode;f.reloadListEditorControl(e)},reloadListEditorControl:function(t){app.refreshHtmlControl(t,function(){f.setuplistEditorControl(t)})},validate:function(){var r=void 0!==app.validation&&"function"==typeof app.validation.validateInput?app.validation.validateInput:null;if(null===r)return console.warn("[app.plugins.listEditor.validate()] was called, however no validation function exists."),[];var i=[],t=document.querySelectorAll(f.listSelector());return Array.prototype.forEach.call(t,function(t){var a=1,e=t.querySelectorAll("[data-list-item]"),l=t.getAttribute("data-list-label");Array.prototype.forEach.call(e,function(t){var e=t.querySelectorAll('input[name^="item-field-"], select[name^="item-field-"], textarea[name^="item-field-"]');Array.prototype.forEach.call(e,function(t){var e=r(t,null,a,l);e&&i.push(e)}),a++})}),i},onRendered:function(){this.setuplistEditorControls()}};app.addPlugin("listEditor",f)}();