!function(){"use strict";var v={listSelector:function(){return null===app.activeVueModel?"[data-edit-list][data-template-id],[data-edit-list][data-template-url]":"[data-edit-list]"},setuplistEditorControls:function(){var t=this,e=document.querySelectorAll(v.listSelector());Array.prototype.forEach.call(e,function(e){try{t.setuplistEditorControl(e)}catch(t){app.showError(e,t)}})},setuplistEditorControl:function(t){for(var e,a,l,i,r,o,n,d=t.getAttribute("data-edit-list"),u=t.querySelectorAll("[data-list-item]"),c=t.querySelector("[data-add-item]"),p=0,s=u.length;p<s;p++){for(i=0,r=(e=u[p].querySelectorAll('[name^="item-field-"]')).length;i<r;i++)"INPUT"!==(o=e[i].nodeName)&&"TEXTAREA"!==o&&"SELECT"!==o||(e[i].setAttribute("data-array",d),e[i].setAttribute("data-index",p),n=void 0===e[i].oninput?"change":"input",e[i].addEventListener(n,v.listItemValueChanged));null!==(l=u[p].querySelector("[data-delete-button]"))&&(l.setAttribute("data-array",d),l.setAttribute("data-index",p),l.addEventListener("click",v.listItemDeleteClick),l.style.cursor="pointer")}null!==c&&null!==(a=c.querySelector("[data-add-button]"))&&(a.setAttribute("data-array",d),a.style.cursor="pointer",a.addEventListener("click",v.listItemAddClick)),void 0!==app.events&&"function"==typeof app.events.dispatch&&app.events.dispatch("listEditor.loadedListEditorControl",t)},getFormFieldValue:function(t){var e,a=t.nodeName,l=t.type,i=t.getAttribute("data-type"),r=null;switch(""===(r="INPUT"===a||"SELECT"===a||"TEXTAREA"===a?"checkbox"===l||"radio"===l?t.checked:t.value:t.textContent.trim())&&(r=null),i){case"int":e=parseInt(r,10),isNaN(e)||(r=e);break;case"float":e=parseFloat(r),isNaN(e)||(r=e)}return r},listItemValueChanged:function(t){var e=t.target,a=e.getAttribute("data-array"),l=e.getAttribute("data-index"),i=e.name.substring(11),r=v.getFormFieldValue(e);app.activeVueModel&&app.activeVueModel[a]?app.activeVueModel[a][l][i]=r:app.activeModel[a][l][i]=r},listItemAddClick:function(t){for(var e,a,l=t.target,i=l.getAttribute("data-array"),r=v.getParentControl(l),o={},n=r.querySelector("[data-add-item]").querySelectorAll('[name^="item-field-"]'),d=0,u=n.length;d<u;d++)e=n[d].name.substring(11),a=v.getFormFieldValue(n[d]),o[e]=a;app.activeVueModel&&app.activeVueModel[i]?(app.activeVueModel[i].push(o),app.activeVueModel.$nextTick(function(){v.setuplistEditorControl(r),Array.prototype.forEach.call(n,function(t){var e=t.nodeName,a=t.type,l=t.getAttribute("data-default");"INPUT"!==e&&"SELECT"!==e&&"TEXTAREA"!==e||("checkbox"===a||"radio"===a?t.checked=null!==l&&"true"===l:t.value=null===l?"":l)})})):(app.activeModel[i].push(o),v.reloadListEditorControl(r))},listItemDeleteClick:function(t){var e=t.target,a=e.getAttribute("data-array"),l=parseInt(e.getAttribute("data-index"),10),i=v.getParentControl(e);app.activeVueModel&&app.activeVueModel[a]?app.activeVueModel[a].splice(l,1):(app.activeModel[a].splice(l,1),v.reloadListEditorControl(i))},getParentControl:function(t){var e=t.parentNode;if(null!==app.activeVueModel)for(;null!==e&&null===e.getAttribute("data-edit-list");)e=e.parentNode;else for(;null!==e&&null===e.getAttribute("data-edit-list")&&null===e.getAttribute("data-template-url")&&null===e.getAttribute("data-template-id");)e=e.parentNode;return e},reloadListEditorControl:function(t){app.refreshHtmlControl(t,function(){v.setuplistEditorControl(t)})},validate:function(){var i=void 0!==app.validation&&"function"==typeof app.validation.validateInput?app.validation.validateInput:null;if(null===i)return console.warn("[app.plugins.listEditor.validate()] was called, however no validation function exists."),[];var r=[],t=document.querySelectorAll(v.listSelector());return Array.prototype.forEach.call(t,function(t){var a=1,e=t.querySelectorAll("[data-list-item]"),l=t.getAttribute("data-list-label");Array.prototype.forEach.call(e,function(t){var e=t.querySelectorAll('input[name^="item-field-"], select[name^="item-field-"], textarea[name^="item-field-"]');Array.prototype.forEach.call(e,function(t){var e=i(t,null,a,l);e&&r.push(e)}),a++})}),r},onRendered:function(){this.setuplistEditorControls()}};app.addPlugin("listEditor",v)}();