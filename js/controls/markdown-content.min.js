!function(){"use strict";var i=!1;function o(t,e){if(void 0===window.hljs)return i?t:"";if(e&&hljs.getLanguage(e))try{return hljs.highlight(e,t).value}catch(t){console.warn(t)}try{return hljs.highlightAuto(t).value}catch(t){console.warn(t)}return i?t:""}var a={data:{bind:null,content:null,url:null,loadingSelector:null,showSource:!1},onLoad:function(t,e){var n;void 0===Object.getOwnPropertyDescriptor(t,"url")&&(Object.defineProperty(t,"url",{get:function(){return this.getAttribute("data-url")},set:function(t){this.url!==t&&(this.setAttribute("data-url",t),app.loadJsControl(this))}}),Object.defineProperty(t,"showSource",{get:function(){return this.hasAttribute("data-show-source")},set:function(t){this.showSource!==t&&(t?this.setAttribute("data-show-source",""):this.removeAttribute("data-show-source"),app.loadJsControl(this))}}),t.clearContent=function(){t.innerHTML="",a.dispatchRendered(t)}),this.url?a.fetch.call(this,t):((n=t.querySelector('script[type="text/markdown"]'))?this.content=n.innerHTML:this.bind&&(this.content=e&&e[this.bind]?e[this.bind]:null,null===this.content&&void 0!==app.plugins.dataBind&&"function"==typeof app.plugins.dataBind.getBindValue&&(this.content=app.plugins.dataBind.getBindValue(this.bind,e))),a.render.call(this,t))},dispatchRendered:function(t){var e,n="app:markdownRendered";"function"==typeof Event?e=new Event(n,{bubbles:!0}):(e=document.createEvent("Event")).initEvent(n,!0,!1),t.dispatchEvent(e)},fetch:function(e){var t;this.loadingSelector&&((t=document.querySelector(this.loadingSelector))?e.innerHTML=t.innerHTML:console.warn('Could not find template from <markdown-content [loading-selector="'+this.loadingSelector+'"]>.'));var n=this;fetch(this.url).then(function(t){return t.text()}).then(function(t){n.content=t,a.render.call(n,e)})},render:function(t){if(null===this.content)return t.innerHTML="",void a.dispatchRendered(t);var e,n,r=t.querySelector('script[type="text/markdown"]');if(r&&r.parentNode.removeChild(r),this.showSource)return t.innerHTML="<pre></pre>",t.querySelector("pre").textContent=this.content,r&&t.appendChild(r),void a.dispatchRendered(t);if(i=!1,window.marked)i=!0,marked.setOptions({highlight:o}),e=marked(this.content);else if(window.markdownit)n=markdownit({html:!0,linkify:!0,typographer:!0,highlight:o}),window.markdownitEmoji&&n.use(markdownitEmoji),e=n.render(this.content);else{if(!window.remarkable)return app.showError(t,"Error - Unable to show Markdown content because a Markdown JavaScript library was not found on the page."),void a.dispatchRendered(t);e=(n=new remarkable.Remarkable({html:!0,typographer:!0,highlight:o})).render(this.content)}t.innerHTML=e,r&&t.appendChild(r),void 0!==window.hljs&&(r=document.querySelectorAll('code[class*="language-"]'),Array.prototype.forEach.call(r,function(t){t.classList.add("hljs")})),a.dispatchRendered(t)}};app.addControl("markdown-content",a)}();