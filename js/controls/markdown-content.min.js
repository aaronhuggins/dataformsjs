!function(){"use strict";var i=!1;function o(e,t){if(void 0===window.hljs)return i?e:"";if(t&&hljs.getLanguage(t))try{return hljs.highlight(t,e).value}catch(e){console.warn(e)}try{return hljs.highlightAuto(e).value}catch(e){console.warn(e)}return i?e:""}var a={data:{bind:null,content:null,url:null,loadingSelector:null,showSource:!1,errorMessage:null},onLoad:function(e,t){var n;void 0===Object.getOwnPropertyDescriptor(e,"url")&&(Object.defineProperty(e,"url",{get:function(){return this.getAttribute("data-url")},set:function(e){this.url!==e&&(this.setAttribute("data-url",e),app.loadJsControl(this))}}),Object.defineProperty(e,"showSource",{get:function(){return this.hasAttribute("data-show-source")},set:function(e){this.showSource!==e&&(e?this.setAttribute("data-show-source",""):this.removeAttribute("data-show-source"),app.loadJsControl(this))}}),e.clearContent=function(){e.innerHTML="",a.dispatchRendered(e)}),this.url?a.fetch.call(this,e):((n=e.querySelector('script[type="text/markdown"]'))?this.content=n.innerHTML:this.bind&&(this.content=t&&t[this.bind]?t[this.bind]:null,null===this.content&&void 0!==app.plugins.dataBind&&"function"==typeof app.plugins.dataBind.getBindValue&&(this.content=app.plugins.dataBind.getBindValue(this.bind,t))),a.render.call(this,e))},dispatchRendered:function(e){var t,n="app:markdownRendered";"function"==typeof Event?t=new Event(n,{bubbles:!0}):(t=document.createEvent("Event")).initEvent(n,!0,!1),e.dispatchEvent(t)},fetch:function(t){var e;this.loadingSelector&&((e=document.querySelector(this.loadingSelector))?t.innerHTML=e.innerHTML:console.warn('Could not find template from <markdown-content [loading-selector="'+this.loadingSelector+'"]>.'));var n=this,r=this.url;app.fetch(r,null,"text/plain").then(function(e){n.content=e,n.errorMessage=null,a.render.call(n,t)}).catch(function(e){e="Error loading markdown content from ["+r+"]. Error: "+e;n.errorMessage=e,a.render.call(n,t)})},render:function(e){if(this.errorMessage)return app.showError(e,this.errorMessage),void a.dispatchRendered(e);if(null===this.content)return e.innerHTML="",void a.dispatchRendered(e);var t,n,r=e.querySelector('script[type="text/markdown"]');if(r&&r.parentNode.removeChild(r),this.showSource)return e.innerHTML="<pre></pre>",e.querySelector("pre").textContent=this.content,r&&e.appendChild(r),void a.dispatchRendered(e);if(i=!1,window.marked)i=!0,marked.setOptions({highlight:o}),t=marked(this.content);else if(window.markdownit)n=markdownit({html:!0,linkify:!0,typographer:!0,highlight:o}),window.markdownitEmoji&&n.use(markdownitEmoji),t=n.render(this.content);else{if(!window.remarkable)return app.showError(e,"Error - Unable to show Markdown content because a Markdown JavaScript library was not found on the page."),void a.dispatchRendered(e);t=(n=new remarkable.Remarkable({html:!0,typographer:!0,highlight:o}).use(remarkable.linkify)).render(this.content)}e.innerHTML=t,r&&e.appendChild(r),void 0!==window.hljs&&(r=e.querySelectorAll('code[class*="language-"]'),Array.prototype.forEach.call(r,function(e){e.classList.add("hljs")})),a.dispatchRendered(e)}};app.addControl("markdown-content",a)}();