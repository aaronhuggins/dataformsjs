// @link https://www.dataformsjs.com
// @version 5.13.0
// @author Conrad Sollitt (https://conradsollitt.com)
// @license MIT
!function(){"use strict";var n=void 0===window.React&&void 0!==window.preact?window.preact:window.React;function w(e){return(w="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function u(e,t){return null!=t&&"undefined"!=typeof Symbol&&t[Symbol.hasInstance]?t[Symbol.hasInstance](e):e instanceof t}function e(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&c(e,t)}function c(e,t){return(c=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function t(r){var n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=p(r),t=(e=n?(e=p(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),this);if(e&&("object"===w(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return o(t)}}function o(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function p(e){return(p=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function r(e,t){if(!u(e,t))throw new TypeError("Cannot call a class as a function")}function h(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function i(e,t,r){return t&&h(e.prototype,t),r&&h(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}var f={},m=(i(y,null,[{key:"get",value:function(e,t){return void 0===f[e]?t:f[e]}},{key:"set",value:function(e,t){f[e]=t}}]),y);function y(){r(this,y)}window.Cache=m;i(g,null,[{key:"ponyfill",value:function(){var e,t,r='link[rel="stylesheet"][data-css-vars-ponyfill]:not([data-css-vars-setup]),style[data-css-vars-ponyfill]:not([data-css-vars-setup])',n=document.querySelectorAll(r);0!==n.length&&(e=new A,t=window.CSS&&window.CSS.supports&&window.CSS.supports("(--a: 0)"),e.loadPolyfill(t,"https://cdn.jsdelivr.net/npm/css-vars-ponyfill@2.4.3/dist/css-vars-ponyfill.min.js").then(function(){window.cssVars&&(cssVars({include:r}),Array.prototype.forEach.call(n,function(e){e.setAttribute("data-css-vars-setup","")}))}))}}]);var v=g;function g(){r(this,g)}window.CssVars=v;e(a,n.Component),b=t(a),i(a,[{key:"componentDidCatch",value:function(e,t){this.setState({error:e,errorInfo:t})}},{key:"render",value:function(){return this.state.errorInfo?n.createElement("div",null,n.createElement("h2",{style:{textAlign:"left",color:"white",backgroundColor:"#bc0000",padding:"1em"}},"An error has occurred"),n.createElement("details",{style:{whiteSpace:"pre-wrap",textAlign:"left",color:"white",backgroundColor:"red",padding:"1em"}},this.state.error&&this.state.error.toString(),n.createElement("br",null),this.state.errorInfo.componentStack)):this.props.children}}]);var b,S=a;function a(e){return r(this,a),(e=b.call(this,e)).state={error:null,errorInfo:null},e}window.ErrorBoundary=S;i(E,[{key:"number",value:function(e){return this.formatNumber(e,{})}},{key:"round",value:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0;return this.formatNumber(e,{style:"decimal",maximumFractionDigits:t,minimumFractionDigits:t})}},{key:"currency",value:function(e,t){return this.formatNumber(e,{style:"currency",currency:t,maximumFractionDigits:2})}},{key:"percent",value:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0;return this.formatNumber(e,{style:"percent",maximumFractionDigits:t,minimumFractionDigits:t})}},{key:"date",value:function(e){return this.formatDateTime(e,{})}},{key:"dateTime",value:function(e){return this.formatDateTime(e,{year:"numeric",month:"numeric",day:"numeric",hour:"numeric",minute:"numeric",second:"numeric"})}},{key:"time",value:function(e){return this.formatDateTime(e,{hour:"numeric",minute:"numeric",second:"numeric"})}},{key:"isNumber",value:function(e){return!isNaN(parseFloat(e))&&isFinite(e)}},{key:"formatDateTime",value:function(t,r){if(void 0===window.Intl)return t;if(null===t||""===t)return null;try{return u(t,Date)?new Intl.DateTimeFormat(navigator.language,r).format(t):/^\d{4}-\d{2}-\d{2}$/.test(t)?(e=t.split("-").map(function(e){return parseInt(e,10)}),n=new Date(e[0],e[1]-1,e[2]),new Intl.DateTimeFormat(navigator.language,r).format(n)):(o=new Date(t),new Intl.DateTimeFormat(navigator.language,r).format(o));var e,n,o}catch(e){return console.warn("Error formatting Date/Time Value:"),console.log(navigator.language),console.log(r),console.log(t),console.log(e),"Error"}}},{key:"formatNumber",value:function(t,r){var n=navigator.language||navigator.userLanguage;if(null===t||""===t)return null;if(!this.isNumber(t))return console.warn("Warning value specified in DateFormsJS function formatNumber() is not a number:"),console.log(t),t;if(void 0===window.Intl){var e=r.style||null,o=r.maximumFractionDigits||0;if("percent"===e)return(100*t).toFixed(o)+"%";var o=null,i=null,a=null;return"en-us"===n&&(o=",",i=".",a="$"),null!==o?((o=t.toString().split("."))[0]=o[0].replace(/\B(?=(\d{3})+(?!\d))/g,","),o=o.join(i),"currency"===e?a+o:o):t}try{return new Intl.NumberFormat(n,r).format(t)}catch(e){return console.warn("Error formatting Numeric Value:"),console.log(n),console.log(r),console.log(t),console.log(e),"Error"}}}]);var C=E;function E(){r(this,E)}window.Format=C;e(s,n.Component),L=t(s),i(s,[{key:"componentDidMount",value:function(){this.filter()}},{key:"onChange",value:function(){this.filter(),"function"==typeof this.props.afterFilter&&this.props.afterFilter()}},{key:"filter",value:function(){for(var e=this.input.current,c=e.value.toLowerCase().split(" "),d=c.length,p=0!==d,t=0,r=null,n=null,o=document.querySelectorAll(this.props["filter-selector"]),i=(1===o.length&&"TABLE"===o[0].tagName&&o[0].tHead&&1===o[0].tHead.rows.length&&1===o[0].tBodies.length&&(r=(i=o[0]).getAttribute("data-sort-class-odd"),n=i.getAttribute("data-sort-class-even"),o=o[0].tBodies[0].rows),o.length),h=n&&r,f=0,m=o.length;f<m;f++){var a=o[f],y=!0;if(p)for(var v=a.textContent.toLowerCase(),s=0;s<d;s++)if(""!==c[s]&&!v.includes(c[s])){y=!1;break}y&&(t++,h&&(t%2==0?(a.classList.add(n),a.classList.remove(r)):(a.classList.add(r),a.classList.remove(n)))),a.style.display=y?"":"none"}var g,l,u=e.getAttribute("filter-results-selector");u&&((u=document.querySelector(u))?(g=e.getAttribute("filter-results-text-all"),e=e.getAttribute("filter-results-text-filtered"),null!==g||null!==e?(l=null,t===i?l=g:null!==e&&(l=e.replace(/{displayCount}/g,t)),null===l?u.textContent="":(l=l.replace(/{totalCount}/g,i),u.textContent=l)):console.warn("Defined [filter-results-selector] without [filter-results-text-all] or [filter-results-text-filtered]")):console.warn("Defined [filter-results-selector] but element not found"))}},{key:"render",value:function(){return void 0!==window&&window.React===window.preact?n.createElement("input",Object.assign({},this.props,{onInput:this.onChange,ref:this.input})):n.createElement("input",Object.assign({},this.props,{onChange:this.onChange,ref:this.input}))}}]);var L,k=s;function s(e){return r(this,s),(e=L.call(this,e)).onChange=e.onChange.bind(o(e)),e.input=n.createRef(),e}window.InputFilter=k;var d=[],D={};function O(e){return 0===e.fetchState&&e.children?e.children:null}function T(e){if(!(-1===e.fetchState)||!e.children)return null;var t=e.error;return"string"==typeof t&&-1===t.indexOf("Error")&&(t="Error - "+t),n.cloneElement(e.children,{error:t})}function x(e){return 1===e.fetchState&&e.children?n.cloneElement(e.children,{data:e.data,params:e.params,handleChange:e.handleChange,childProps:e.childProps}):null}e(l,n.Component),P=t(l),i(l,[{key:"getUrlParams",value:function(){var e,t={};if(this.props&&!0===this.props.graphQL)return void 0===this.props.variables?{}:this.props.variables;for(e in this.props)"url"!==e&&"string"==typeof this.props[e]&&(t[e]=this.props[e]);return t}},{key:"componentDidMount",value:function(){if((this._isMounted=!0)===this.props.graphQL&&void 0===this._query&&void 0!==this._querySrc&&void 0!==D[this._querySrc]&&(this._query=D[this._querySrc]),this.props.loadOnlyOnce){var e=function(e,t,r){for(var n=0,o=d.length;n<o;n++){var i=d[n];if(i.url===e&&i.query===t){if(JSON.stringify(r)===i.params)return i.data;break}}return null}(this.props.url,this._query,this.getUrlParams());if(null!==e)return void this.setState({fetchState:1,data:e})}var t,r;if(!0===this.props.graphQL&&void 0===this._query&&void 0!==this._querySrc)return t=this._querySrc,r=this,void fetch(t,null).then(function(e){var t=e.status;return 200<=t&&t<300||304===t?Promise.resolve(e):(t="Error loading data. Server Response Code: "+t+", Response Text: "+e.statusText,Promise.reject(t))}).then(function(e){return e.text()}).then(function(e){D[t]=e,r._query=D[t],r.fetchData()}).catch(function(e){throw new Error("Error Downloading GraphQL Script: ["+t+"], Error: "+e.toString())});this.fetchData()}},{key:"componentDidUpdate",value:function(e,t){(!0===this.props.graphQL?JSON.stringify(e.variables)!==JSON.stringify(this.props.variables):this.buildUrl(t.params)!==this.buildUrl(this.props))&&this.setState({params:this.getUrlParams()},this.fetchData)}},{key:"componentWillUnmount",value:function(){this._isMounted=!1}},{key:"buildUrl",value:function(e){var t=this.props.url;if(!0!==this.props.graphQL&&0<Object.keys(e).length)for(var r in e)-1<t.indexOf(":"+r)&&(t=t.replace(new RegExp(":"+r,"g"),encodeURIComponent(e[r])));return t}},{key:"fetchData",value:function(){var e,t,c=this,r=this.buildUrl(this.state.params);this._isFetching||(this._isFetching=!0,e={mode:"cors",cache:"no-store",credentials:"same-origin"},this.props.fetchOptions&&(e=this.props.fetchOptions),this.props.fetchHeaders&&(e.headers=this.props.fetchHeaders),!0===this.props.graphQL&&(t=void 0===this.props.variables?{}:this.props.variables,"file://"===window.location.origin||"null"===window.location.origin?r=(r=(r+=-1===r.indexOf("?")?"?":"&")+"query="+encodeURIComponent(this._query.trim()))+"&variables="+encodeURIComponent(JSON.stringify(t)):(e.method="POST",void 0===e.headers?e.headers={"Content-Type":"application/json"}:e.headers["Content-Type"]="application/json",e.body=JSON.stringify({query:this._query,variables:t}))),this.setState({fetchState:0},function(){c.updateView(),fetch(r,e).then(function(e){var t=e.status;return 200<=t&&t<300||304===t?Promise.resolve(e):(t="Error loading data. Server Response Code: "+t+", Response Text: "+e.statusText,Promise.reject(t))}).then(function(e){return e.json()}).then(function(e){var t,r=!0===c.props.graphQL;if(r&&(e.errors&&e.errors.length))throw t=1===e.errors.length&&e.errors[0].message?"[GraphQL Error]: "+e.errors[0].message:("string"==typeof c.props.errorTextGraphQLErrors?c.props.errorTextGraphQLErrors:"{count} GraphQL Errors occurred. See console for full details.").replace("{count}",e.errors.length),console.error(e.errors),t;if(c._isMounted&&c.setState({fetchState:1,data:r?e.data:e}),c.props.loadOnlyOnce){for(var n=c.props.url,o=c._query,i=c.getUrlParams(),a=r?e.data:e,s=0,l=d.length;s<l;s++){var u=d[s];if(u.url===n&&u.query===o)return void(u.params=JSON.stringify(i),u.data=a)}d.push({url:n,query:o,params:JSON.stringify(i),data:a})}}).catch(function(e){c._isMounted&&c.setState({fetchState:-1,error:e.toString()})}).finally(function(){c._isFetching=!1,c.updateView()})}))}},{key:"handleChange",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:null;this._isMounted&&this.setState({data:null===e?this.state.data:e})}},{key:"updateView",value:function(){if("function"==typeof this.props.onViewUpdated)try{this.props.onViewUpdated()}catch(e){console.error(e)}}},{key:"render",value:function(){return n.createElement(n.Fragment,null,n.createElement(O,{fetchState:this.state.fetchState},this.props.isLoading),n.createElement(T,{fetchState:this.state.fetchState,error:this.state.error},this.props.hasError),n.createElement(x,{fetchState:this.state.fetchState,data:this.state.data,params:this.state.params,handleChange:this.handleChange,childProps:this.props.childProps},this.props.isLoaded))}}]);var P,_=l;function l(e){var t;return r(this,l),(t=P.call(this,e))._isFetching=!1,t._isMounted=!1,t.fetchData=t.fetchData.bind(o(t)),t.handleChange=t.handleChange.bind(o(t)),t._querySrc=e&&e.querySrc?e.querySrc:void 0,t._query=e&&e.query?e.query:void 0,t.state={fetchState:0,error:null,params:t.getUrlParams(),data:null},t}window.JsonData=_;e(q,n.Component),j=t(q),i(q,[{key:"componentDidMount",value:function(){var e=this;this.loadScripts(this.props.scripts,this.props.loadScriptsInOrder).then(function(){e.setState({isReady:!0})})}},{key:"loadScripts",value:function(i,e){function a(i){return new Promise(function(e){for(var t=document.querySelectorAll("link"),r=0,n=t.length;r<n;r++)if("stylesheet"===t[r].rel&&t[r].getAttribute("href")===i)return void e();var o=document.createElement("link");o.rel="stylesheet",o.onload=e,o.onerror=function(){console.error("Error loading CSS File: "+i),e()},o.href=i,document.head.appendChild(o)})}function s(i){return new Promise(function(e){for(var t=document.querySelectorAll("script"),r=0,n=t.length;r<n;r++)if(t[r].getAttribute("src")===i)return void e();var o=document.createElement("script");o.onload=e,o.onerror=function(){console.error("Error loading JS File: "+i),e()},o.src=i,document.head.appendChild(o)})}function l(i){return new Promise(function(e){for(var t=document.querySelectorAll("script[data-src][data-compiler]"),r=0,n=t.length;r<n;r++)if(t[r].getAttribute("data-src")===i)return void e();var o=document.createElement("script");o.type="text/babel",o.setAttribute("src",i),document.head.appendChild(o),jsxLoader.loadScript(o).then(function(){e()})})}if("string"==typeof i)i=[i];else if(!Array.isArray(i))return console.error("Invalid prop for <LazyLoad>, expected [scripts] to be a string or an array of strings. Check console."),console.log(i),new Promise(function(e){e()});return!0===e?new Promise(function(r){var n=0,o=i.length;!function e(){var t;n!==o?(t=i[n],n++,t.endsWith(".js")?s(t).then(e):t.endsWith(".css")?a(t).then(e):t.endsWith(".jsx")?l(t).then(e):(console.error("Invalid Script for <LazyLoad>. Only scripts ending with [js, css, or jsx] can be used. Error URL: "+t),e())):r()}()}):new Promise(function(e){for(var t=[],r=0,n=i.length;r<n;r++){var o=i[r];o.endsWith(".js")?t.push(s(o)):o.endsWith(".css")?t.push(a(o)):o.endsWith(".jsx")?t.push(l(o)):console.error("Invalid Script for <LazyLoad>. Only scripts ending with [js, css, or jsx] can be used. Error URL: "+o)}Promise.all(t).then(function(){e()})})}},{key:"loadPolyfill",value:function(e,o){return!1===e||void 0===e?new Promise(function(e,t){var r,n;r=e,n=t,(e=document.createElement("script")).onload=function(){r()},e.onerror=function(){console.error("Error loading Script: "+o),n()},e.src=o,document.head.appendChild(e)}):new Promise(function(e){e()})}},{key:"render",value:function(){if(!this.state.isReady)return this.props.isLoading||null;if(this.props.children)return this.props.children;if(this.props.isLoaded){if("string"!=typeof this.props.isLoaded)return this.props.isLoaded;var e,t=this.props.isLoaded,r={};for(e in this.props)this.props.hasOwnProperty(e)&&"scripts"!==e&&"isLoaded"!==e&&"isLoading"!==e&&(r[e]=this.props[e]);if(void 0!==window&&void 0!==window[t])return n.createElement(window[t],r);if(void 0!==globalThis&&void 0!==globalThis[t])return n.createElement(globalThis[t],r);throw new TypeError("Component <LazyLoad isLoaded="+JSON.stringify(t)+"> was not found. Check if your script is missing or has a compile error.")}throw new TypeError("Missing child nodes or the [isLoaded] property for a <LazyLoad> element.")}}]);var j,A=q;function q(e){return r(this,q),(e=j.call(this,e)).state={isReady:!1},e}window.LazyLoad=A;e(I,n.Component),F=t(I),i(I,[{key:"componentDidMount",value:function(){this.setupTable()}},{key:"setupTable",value:function(){var e=this.table.current;if(null===e.tHead)return console.warn("Unable to setup sorting for table because there is no <thead> element"),void console.log(e);if(0===e.tHead.rows.length)return console.warn("Unable to setup sorting for table because the <thead> element contained now rows"),void console.log(e);if(0===e.tBodies.length)return console.warn("Unable to setup sorting for table because the <tbody> element is missing"),void console.log(e);if(1!==e.tBodies.length)return console.warn("Unable to setup sorting for table because there can only be one <tbody> element for the table"),void console.log(e);for(var t=e.tHead.rows[e.tHead.rows.length-1],r=0,n=t.cells.length;r<n;r++)t.cells[r].addEventListener("click",this.sortColumn),t.cells[r].style.cursor="pointer"}},{key:"sortColumn",value:function(e){var e=e.target,t=e&&e.parentElement&&e.parentElement.parentElement?e.parentElement.parentElement.parentElement:null;if("TH"!==e.tagName&&"TD"!==e.tagName)return console.warn("SortableTable.sortColumn() was called with an invalid element. If called manually the cell needs to be passed."),void console.log(e);if(null!=t&&"TABLE"!==t.tagName)return console.warn("SortableTable.sortColumn() was called with an invalid element. If called manually the table cell of the last row from the table header should be used."),void console.log(e);for(var c=t.getAttribute("data-sort-column"),r=e.cellIndex,e="asc",d=(null!==c&&parseInt(c,10)===r&&(e="asc"===t.getAttribute("data-sort-order")?"desc":"asc"),t.tBodies[0]),n=d.rows,o=[],i=0,p=n.length;i<p;i++){var a,s,l=n[i].cells[r];void 0!==l&&(l=w(a=(null!==(a=l.getAttribute("data-value"))?a:l.textContent).trim()),""===a?a=null:isNaN(a)?(s=new Date(a),isNaN(s.getTime())?a=void 0!==a.toLocaleLowerCase?a.toLocaleLowerCase():a.toLowerCase():(a=s,l="date")):a=parseFloat(a),o.push({row:n[i],value:a,type:null===a?null:l}))}o.sort(this.sortCompare),"desc"===e&&o.reverse();for(var h=t.getAttribute("data-sort-class-odd"),f=t.getAttribute("data-sort-class-even"),m=h&&f,y=0,v=0,g=o.length;v<g;v++){var u=o[v].row;m&&"none"!==u.style.display&&(++y%2==0?(u.classList.add(f),u.classList.remove(h)):(u.classList.add(h),u.classList.remove(f))),d.appendChild(u)}t.setAttribute("data-sort-column",r),t.setAttribute("data-sort-order",e)}},{key:"sortCompare",value:function(e,t){return null===e.type&&null!==t.type?-1:null===t.type&&null!==e.type?1:null===e.type&&null===t.type?0:"number"===e.type&&"number"!==t.type?-1:"number"===t.type&&"number"!==e.type?1:"number"===e.type&&"number"===t.type?e.value-t.value:"date"===e.type&&"date"!==t.type?-1:"date"===t.type&&"date"!==e.type?1:"date"===e.type&&"date"===t.type?e.value<t.value?-1:e.value>t.value?1:0:"string"===e.type&&"string"===t.type?void 0!==e.value.localeCompare?e.value.localeCompare(t.value):e.value<t.value?-1:e.value>t.value?1:0:(console.warn("A code change from [SortableTable] impacted sorting and caused an expected error so the data may appear out of order. Please review your code changes"),0)}},{key:"render",value:function(){return n.createElement("table",Object.assign({},this.props,{ref:this.table}),this.props.children)}}]);var F,N=I;function I(e){return r(this,I),(e=F.call(this,e)).sortColumn=e.sortColumn.bind(o(e)),e.table=n.createRef(),e}function R(){r(this,R)}window.SortableTable=N,i(R,null,[{key:"Cache",get:function(){return m}},{key:"CssVars",get:function(){return v}},{key:"ErrorBoundary",get:function(){return S}},{key:"Format",get:function(){return C}},{key:"InputFilter",get:function(){return k}},{key:"JsonData",get:function(){return _}},{key:"LazyLoad",get:function(){return A}},{key:"SortableTable",get:function(){return N}}]),window.DataFormsJS=R}();