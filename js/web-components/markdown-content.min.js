import{showError}from"./utils.min.js";const shadowTmpl=document.createElement("template");shadowTmpl.innerHTML="\n    <style>\n        :host { display: block; }\n        :host([hidden]) { display: none; }\n    </style>\n    <slot></slot>\n";let returnCode=!1;function highlight(t,e){if(void 0===window.hljs)return returnCode?t:"";if(e&&hljs.getLanguage(e))try{return hljs.highlight(e,t).value}catch(t){console.warn(t)}try{return hljs.highlightAuto(t).value}catch(t){console.warn(t)}return returnCode?t:""}class MarkdownContent extends HTMLElement{constructor(){super();this.attachShadow({mode:"open"}).appendChild(shadowTmpl.content.cloneNode(!0)),this.content=null}connectedCallback(){const t=this.querySelector('script[type="text/markdown"]');t&&(this.content=t.innerHTML),this.render()}static get observedAttributes(){return["url","show-source"]}attributeChangedCallback(t,e,n){switch(t){case"url":e!==n&&this.fetch();break;case"show-source":e!==n&&this.render()}}clearContent(){this.content=null,this.render()}get url(){return this.getAttribute("url")}set url(t){this.setAttribute("url",t)}get showSource(){return this.hasAttribute("show-source")}set showSource(t){t?this.setAttribute("show-source",""):this.removeAttribute("show-source")}get value(){return this.content}set value(t){this.content=t,this.render()}fetch(){const t=this.url;if(!t)return showError(this,"Error - Unable to show Markdown content because [url] is not set."),void this.dispatchRendered();const e=this.getAttribute("loading-selector");if(e){const t=document.querySelector(e);t?(this.innerHTML="",this.appendChild(t.content.cloneNode(!0))):console.warn(`Could not find template from <${this.tagName.toLowerCase()} [loading-selector="${e}"]>.`)}fetch(t).then((t=>t.text())).then((t=>{this.content=t,this.render()}))}dispatchRendered(){this.dispatchEvent(new Event("app:markdownRendered",{bubbles:!0}))}render(){if(null===this.content)return this.innerHTML="",void this.dispatchRendered();if(this.showSource)return this.innerHTML="<pre></pre>",this.querySelector("pre").textContent=this.content,void this.dispatchRendered();let t,e;if(returnCode=!1,window.marked)returnCode=!0,marked.setOptions({highlight:highlight}),t=marked(this.content);else if(window.markdownit)e=markdownit({html:!0,linkify:!0,typographer:!0,highlight:highlight}),window.markdownitEmoji&&e.use(markdownitEmoji),t=e.render(this.content);else{if(!window.remarkable)return showError(this,"Error - Unable to show Markdown content because a Markdown JavaScript library was not found on the page."),void this.dispatchRendered();e=new remarkable.Remarkable({html:!0,typographer:!0,highlight:highlight}),t=e.render(this.content)}this.innerHTML=t,this.dispatchRendered()}}window.customElements.define("markdown-content",MarkdownContent);