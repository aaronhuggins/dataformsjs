!function(){"use strict";var t="web-components-polyfill-css",e=["[data-control] { display:block; padding:0; margin:0; }",'div[data-control="json-data"] > div.is-loading,','div[data-control="json-data"] > div.has-error,','div[data-control="json-data"] > div.is-loaded { padding:0; margin:0; }'].join("\n"),r={jsonData:function(t){var e=t.getAttribute("url");t.setAttribute("data-url",e);["is-loading","has-error","is-loaded"].forEach(function(e){var r=t.querySelector(e);if(r){var a=document.createElement("div");a.innerHTML=r.innerHTML,a.className=e,r.parentNode.replaceChild(a,r)}})},dataList:function(t){["template-selector","root-element","root-class","error-class"].forEach(function(e){var r=t.getAttribute(e);null!==r&&t.setAttribute("data-"+e,r)})},dataTable:function(t){var e=t.getAttribute("data-bind");t.setAttribute("data-source",e);["highlight-class","labels","columns"].forEach(function(e){var r=t.getAttribute(e);null!==r&&t.setAttribute("data-"+e,r)})},imageGallery:function(t){["image","image-avif","image-webp"].forEach(function(e){var r=t.getAttribute(e);null!==r&&("image"===e?t.setAttribute("data-image-gallery",r):t.setAttribute("data-"+e,r))});var e=t.getAttribute("title");if(null===e){var r=t.querySelector("img[alt]");r&&(e=r.getAttribute("alt"),t.setAttribute("title",e))}},inputFilter:function(t){["filter-selector","filter-results-selector","filter-results-text-all","filter-results-text-filtered"].forEach(function(e){var r=t.getAttribute(e);null!==r&&t.setAttribute("data-"+e,r)})},leafletMap:function(t){t.setAttribute("data-leaflet","");["latitude","latitude","zoom","marker"].forEach(function(e){var r=t.getAttribute(e);null!==r&&t.setAttribute("data-"+e,r)});var e=t.getAttribute("data-bind-attr");e&&!e.includes("data-")&&(e=e.split(",").map(function(t){return"data-"+t.trim()}),t.setAttribute("data-bind-attr",e.join(", ")))}},a={model:{},onRendered:function(){var t=this;app.unloadAllJsControls();var e=document.querySelectorAll("[data-control]"),a=!1;Array.prototype.forEach.call(e,function(t){switch(t.getAttribute("data-control")){case"json-data":r.jsonData(t),app.loadJsControl(t,app.activeModel),a=!0}});var n=document.querySelectorAll("[url-param]");Array.prototype.forEach.call(n,function(e){var r=e.getAttribute("url-param");void 0!==t[r]&&(e.textContent=t[r])}),a||u()}},n={number:function(t){return this.formatNumber(t,{})},currency:function(t,e){var r={style:"currency",currency:e,maximumFractionDigits:2};return this.formatNumber(t,r)},percent:function(t,e){void 0===e&&(e=0);var r={style:"percent",maximumFractionDigits:e,minimumFractionDigits:e};return this.formatNumber(t,r)},date:function(t){return this.formatDateTime(t,{})},dateTime:function(t){return this.formatDateTime(t,{year:"numeric",month:"numeric",day:"numeric",hour:"numeric",minute:"numeric",second:"numeric"})},time:function(t){return this.formatDateTime(t,{hour:"numeric",minute:"numeric",second:"numeric"})},isNumber:function(t){return!isNaN(parseFloat(t))&&isFinite(t)},formatDateTime:function(t,e){if(void 0===window.Intl)return t;try{if(t instanceof Date)return new Intl.DateTimeFormat(navigator.language,e).format(t);if(/^\d{4}-\d{2}-\d{2}$/.test(t)){var r=t.split("-").map(function(t){return parseInt(t,10)}),a=new Date(r[0],r[1]-1,r[2]);return new Intl.DateTimeFormat(navigator.language,e).format(a)}var n=new Date(t);return new Intl.DateTimeFormat(navigator.language,e).format(n)}catch(r){return console.warn("Error formatting Date/Time Value:"),console.log(navigator.language),console.log(e),console.log(t),console.log(r),"Error"}},formatNumber:function(t,e){if(null===t||""===t)return null;if(!this.isNumber(t))return console.warn("Warning value specified in DateFormsJS function formatNumber() is not a number:"),console.log(t),t;if(void 0===window.Intl)return t;try{return new Intl.NumberFormat(navigator.language,e).format(t)}catch(r){return console.warn("Error formatting Numeric Value:"),console.log(navigator.language),console.log(e),console.log(t),console.log(r),"Error"}}},l={data:{bind:null,templateSelector:null,rootElement:null,rootClass:null,errorClass:null},html:function(t){var e=this,r=[];function a(t,a){void 0===a&&(a="div"),e.errorClass?r.push("<"+a+' class="'+app.escapeHtml(e.errorClass)+'">'+app.escapeHtml(t)+"</"+a+">"):r.push("<"+a+' style="color:white; background-color:red; padding:0.5rem 1rem; margin:.5rem;">'+app.escapeHtml(t)+"</"+a+">")}function l(){null!==e.rootElement&&r.push("</"+app.escapeHtml(e.rootElement)+">")}var o=t&&t[this.bind]?t[this.bind]:null;if(null===o||Array.isArray(o)&&0===o.length)return"";if(null!==this.rootElement&&(null===this.rootClass?r.push("<"+app.escapeHtml(this.rootElement)+">"):r.push("<"+app.escapeHtml(this.rootElement)+' class="'+app.escapeHtml(this.rootClass)+'">')),this.templateSelector){var i=document.querySelector(this.templateSelector);if(!i)return a("Error <data-list> Template not found from selector: "+this.templateSelector),l(),r.join("");for(var s,u=i.innerHTML,c=/\$\{([^}]+)\}/g,p=0,d=[],m=0;null!==(s=c.exec(u));)if(d.push(JSON.stringify(u.substring(m,s.index))),d.push("String(app.escapeHtml("+s[1]+"))"),m=s.index+s[0].length,++p>1e3)return void app.showErrorAlert("Unexpected Loop Error in <data-list>");d.push(JSON.stringify(u.substring(m,u.length)));for(var f=!1,h=0,g=d.length;h<g;h++){var v=d[h];if(!v.startsWith("String(app.escapeHtml(")&&v.includes("${")){a("Invalid expression: missing `}` character"),f=!0;break}}if(!f)try{for(var b=new Function("item","index","app","Format","with(item){return "+d.join(" + ")+"}"),y=0,A=o.length;y<A;y++){var w=o[y];try{r.push(b(w,y,app,n))}catch(t){var E="ul"===this.rootElement?"li":"div";a("Item Error - "+t.message,E)}}}catch(t){a("Error Rendering Template - "+t.message)}}else{null===this.rootClass?r.push("<ul>"):r.push('<ul class="'+app.escapeHtml(this.rootClass)+'">');for(var S=0,C=o.length;S<C;S++)r.push("<li>"+app.escapeHtml(o[S])+"</li>");r.push("</ul>")}return l(),r.join("")}},o={data:{source:null,columns:null,labels:null,emptyDataText:"No records found",errorInvalidData:"Error invalid data for table",errorClass:null,defaultErrorStyle:"color:white; background-color:red; padding:0.5rem 1rem; margin:.5rem;",highlightClass:null},onLoad:function(t){var e,r,a,l,o,i,s,u=t.querySelector("template");function c(e){null===u?t.innerHTML=e:(!function(){if(null===u)return void(t.innerHTML="");var e=t.querySelector("table");null!==e&&e.parentNode.removeChild(e)}(),t.insertAdjacentHTML("beforeend",e))}var p=app.activeModel&&app.activeModel[this.source]?app.activeModel[this.source]:null;if(null!==p)if(Array.isArray(p)&&0===p.length)null===this.emptyDataText?c('<table class="no-data"></table>'):c('<table class="no-data"><caption>'+app.escapeHtml(this.emptyDataText)+"<caption></table>");else{var d=!0;if(Array.isArray(p)?p.length>0&&"object"!=typeof p[0]&&(d=!1):d=!1,d){if("string"==typeof this.columns)for(l=0,o=(r=this.columns.split(",")).length;l<o;l++)r[l]=r[l].trim();else r=Object.keys(p[0]);if(a=r,"string"==typeof this.labels){for(l=0,o=(a=this.labels.split(",")).length;l<o;l++)a[l]=a[l].trim();a.length!==r.length&&null===u&&(a=r)}var m=[],f="<table",h=t.getAttribute("table-attr");if(h)for(l=0,o=(h=h.split(",").map(function(t){return t.trim()})).length;l<o;l++){var g=h[l],v=g.indexOf("=");if(v>1){var b=g.substr(0,v).trim(),y=g.substr(v+1).trim();f+=" "+app.escapeHtml(b)+'="'+app.escapeHtml(y)+'"',"is"===b&&"sortable-table"===y&&(f+=" data-sort")}else f+=" "+app.escapeHtml(g)}for(m.push(f+"><thead><tr>"),e=[],l=0,o=a.length;l<o;l++)e.push("<th>"+app.escapeHtml(a[l])+"</th>");if(m.push(e.join("")),m.push("</tr></thead>"),m.push("<tbody>"),null!==u){for(var A,w=u.innerHTML,E=/\$\{([^}]+)\}/g,S=0,C=[],j=0;null!==(A=E.exec(w));)if(C.push(JSON.stringify(w.substring(j,A.index))),C.push("String(app.escapeHtml("+A[1]+"))"),j=A.index+A[0].length,++S>1e3)return void app.showErrorAlert("Unexpected Loop Error in <data-table>");C.push(JSON.stringify(w.substring(j,w.length)));try{for(i=0,s=C.length;i<s;i++){var T=C[i];if(!T.startsWith("String(app.escapeHtml(")&&T.includes("${"))throw new Error("Invalid expression: missing `}` character")}for(var x=new Function("item","index","app","Format","with(item){return "+C.join(" + ")+"}"),H=0,M=p.length;H<M;H++){var D=p[H];try{m.push(x(D,H,app,n))}catch(t){this.errorClass?m.push('<tr class="'+this.errorClass+'">'):m.push('<tr style="'+this.defaultErrorStyle+'">'),m.push('<td colspan="'+r.length+'">Item Error - '+t.message+"}</td></tr>")}}}catch(t){return void(this.errorClass?c('<table class="'+this.errorClass+'"><caption>Error Rendering Template - '+t.message+"}</caption></table>"):c('<table style="'+this.defaultErrorStyle+'"><caption>Error Rendering Template - '+t.message+"</caption></table>"))}}else for(s=r.length,l=0,o=p.length;l<o;l++){for((e=[]).push("<tr>"),i=0;i<s;i++)e.push("<td>"+app.escapeHtml(p[l][r[i]])+"</td>");e.push("</tr>"),m.push(e.join(""))}m.push("</tbody>"),c(m.join("")),t.getAttribute("highlight-class")&&(f+=" "+app.escapeHtml(g)),t.getAttribute("highlight-class")&&t.querySelector("table").classList.add("click-to-highlight")}else c("<table><caption>"+app.escapeHtml(this.errorInvalidData)+"<caption></table>")}}};function i(t){null===app.activeModel&&(app.activeModel={});var e=t.target.type,r="checkbox"===e||"radio"===e?t.target.checked:t.target.value,a=t.target.getAttribute("data-bind");if(-1===a.indexOf("."))app.activeModel[a]=r;else{var n=a.split("."),l="window"===n[0],o=l?window:app.activeModel;for(l&&n.splice(0,1);n.length>0;)a=n[0],1===n.length?o[a]=r:("object"!=typeof o[a]&&(o[a]={}),o=o[a]),n.splice(0,1)}}var s={getBindValue:function(t){if(null===app.activeModel)return null;for(var e=t.split("."),r=e.length>1&&"window"===e[0]?window:app.activeModel,a=0,n=e.length;a<n;a++)r="object"==typeof r&&null!==r?r[e[a]]:null;return void 0===r?null:r},onRendered:function(t){void 0===t&&(t=document);var e=t.querySelectorAll("[data-bind]");Array.prototype.forEach.call(e,function(t){var e=t.getAttribute("data-bind");if(""!==e){var r=s.getBindValue(e),a=t.nodeName;if("INPUT"===a||"SELECT"===a||"TEXTAREA"===a){var l=t.type;"checkbox"===l||"radio"===l?"boolean"==typeof r?t.checked=r:(r=String(r).toLowerCase(),t.checked="1"===r||"true"===r||"yes"===r||"y"===r):t.value=r,i({target:t});var o=void 0===t.oninput?"change":"input";t.addEventListener(o,i)}else if(null!==t.getAttribute("data-control")||-1!==t.tagName.indexOf("-"));else{var u=t.getAttribute("data-format");if(null!==u)if("function"==typeof n[u])r=n[u](r);else if("function"==typeof window[u])try{r=window[u](r)}catch(t){console.error(t),r="Error: "+t.message}else r="Error: Unknown format ["+u+"]";t.textContent=r}}else console.warn("Element has a [data-bind] attribute, but no field specified")}),e=t.querySelectorAll("[data-bind-attr]"),Array.prototype.forEach.call(e,function(t){for(var e=t.getAttribute("data-bind-attr").split(","),r=0,a=e.length;r<a;r++){var n=e[r].trim();if(0===n.indexOf("data-")){var l=t.getAttribute(n+"--tmpl"),o=t.getAttribute(n);if(null===l?t.setAttribute(n+"--tmpl",o):o=l,null!==o){for(var i=0;i<100;){var u=o.indexOf("["),c=o.indexOf("]");if(-1===u||-1===c||c<u)break;var p=o.substring(u+1,c),d=s.getBindValue(p);null===d&&(d=""),o=o.substring(0,u)+d+o.substring(c+1),i++}t.setAttribute(n,o)}}}}),e=t.querySelectorAll("[data-show]"),Array.prototype.forEach.call(e,function(t){if(null===app.activeModel||app.activeModel&&!0!==app.activeModel.isLoaded)t.style.display="none";else{var e=t.getAttribute("data-show");try{var r=new Function("state","Format","with(state){return "+e+"}")(app.activeModel,n);t.style.display=!0===r?"":"none"}catch(e){t.style.display="",console.error("Error evaluating JavaScript expression from [data-show] attribute."),console.error(e)}}})}};function u(){var t=[],e=document.querySelectorAll('[data-control="data-list"], [data-control="data-table"]');Array.prototype.forEach.call(e,function(t){switch(t.getAttribute("data-control")){case"data-table":r.dataTable(t);break;case"data-list":r.dataList(t)}}),app.loadAllJsControls(),(e=document.querySelectorAll("image-gallery")).length>0&&(Array.prototype.forEach.call(e,function(t){r.imageGallery(t)}),t.push("imageGallery"));var a,n=document.querySelector(".click-to-highlight");n&&t.push("clickToHighlight"),(n=document.querySelector("[data-sort]"))&&t.push("sort"),e=document.querySelectorAll("[is]"),Array.prototype.forEach.call(e,function(e){switch(e.getAttribute("is")){case"input-filter":r.inputFilter(e),t.push("filter");break;case"leaflet-map":r.leafletMap(e),t.push("leaflet")}}),(n=document.querySelector("[data-bind]"))&&s.onRendered(),t.forEach(function(t){!function(t){if(void 0!==app.plugins[t])return void app.plugins[t].reload();var e="https://cdn.jsdelivr.net/npm/dataformsjs@latest/js/plugins/"+t+".js";app.loadScripts(e).then(function(){app.plugins[t].reload()})}(t)}),"function"==typeof Event?a=new Event("app:contentReady"):(a=document.createEvent("Event")).initEvent("app:contentReady",!0,!0),document.dispatchEvent(a)}function c(){app.loadScripts(["http://127.0.0.1:8080/js/controls/json-data.js"]).then(function(){app.addPage("polyfillPage",a).addControl("data-list",l).addControl("data-table",o).addPlugin("dataBind",s).loadCss(t,e),app.controls["json-data"].onFetch=function(){app.activeModel=this,app.activeController&&app.activeController.modelName&&(app.models[app.activeController.modelName]=app.activeModel),u()},function(){var t=document.querySelector("url-hash-router"),e="url-hash-route";if(null===t){if(null===(t=document.querySelector("url-router")))return;e="url-route",document.documentElement.setAttribute("data-routing-mode","history")}var r=t.querySelectorAll(e),a=0;Array.prototype.forEach.call(r,function(t){var e=t.getAttribute("path");null!==t.getAttribute("default-route")&&(app.settings.defaultRoute=e);var r=t.getAttribute("redirect");if(null===r){var n,l=t.getAttribute("src");if(null===l){l=void 0;var o=t.querySelector("template");if(null===o)return app.showErrorAlert("Unable to setup route:"),void console.log(t);o.id||(o.id="url-hash-route-template-"+a+"-"+(new Date).getTime(),a++),n=o.id}app.addController({path:e,viewId:n,viewUrl:l,viewEngine:"Text",pageType:"polyfillPage"})}else app.addController({path:e,onRendered:function(){app.changeRoute(this.redirect)},settings:{redirect:r}})}),app.setup()}(),document.querySelector("url-hash-router, url-router")||(app.activeModel={},app.onUpdateViewComplete=function(){a.onRendered()},app.updateView())})}document.addEventListener("DOMContentLoaded",function(){var t=null;void 0!==window.app&&"object"==typeof window.app.plugins&&(t=window.app.plugins,delete window.app);!function(t,e){var r=document.createElement("script");r.onload=e,r.onerror=function(){console.error("Error loading Script: "+t),e()},r.src=t,document.head.appendChild(r)}("https://cdn.jsdelivr.net/npm/dataformsjs@latest/js/DataFormsJS.js",function(){if(null!==t)for(var e in t)t.hasOwnProperty(e)&&app.addPlugin(e,t[e]);var r=!!(Array.from&&window.Promise&&window.fetch&&Promise.prototype.finally);app.loadScript(r,app.settings.polyfillUrl,c)})})}();