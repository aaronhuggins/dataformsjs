import{isAttachedToDom,defineExtendsPolyfill}from"./utils.min.js";class InputFilter extends HTMLInputElement{constructor(){super(),this.addEventListener("input",this.filter)}connectedCallback(){this.setupFilter()}setupFilter(){if(!this.hasAttribute("filter-results-selector"))return void this.filter();let t=0;const e=window.setInterval((()=>{const{elements:l}=this.getElementsToFilter();0===l.length&&t<10?t++:(window.clearInterval(e),isAttachedToDom(this)&&this.filter())}),100)}getElementsToFilter(){let t=null,e=null,l=document.querySelectorAll(this.getAttribute("filter-selector"));if(1===l.length&&"TABLE"===l[0].tagName){const s=l[0];switch(s.tBodies.length){case 0:l=[];break;case 1:l=s.tBodies[0].rows,t=s.getAttribute("data-sort-class-odd"),e=s.getAttribute("data-sort-class-even");break;default:console.warn("Unexpected Table format for Filter Plugin. Only 1 <tbody> element is supported.")}}return{elements:l,cssOdd:t,cssEven:e}}filter(){const t=this.value.toLowerCase().split(" "),e=t.length,l=0!==e;let s=0;const{elements:r,cssOdd:i,cssEven:n}=this.getElementsToFilter(),o=n&&i;for(const u of r){let r=!0;if(l){const l=u.textContent.toLowerCase();for(let s=0;s<e;s++)if(""!==t[s]&&!l.includes(t[s])){r=!1;break}}r&&(s++,o&&(s%2==0?(u.classList.add(n),u.classList.remove(i)):(u.classList.add(i),u.classList.remove(n)))),u.style.display=r?"":"none"}const u=this.getAttribute("filter-results-selector");if(u){const t=document.querySelector(u);if(!t)return void console.warn("Defined [filter-results-selector] but element not found");const e=this.getAttribute("filter-results-text-all"),l=this.getAttribute("filter-results-text-filtered");if(!e)return void console.warn("Defined [filter-results-selector] without [filter-results-text-all]");if(!l)return void console.warn("Defined [filter-results-selector] without [filter-results-text-filtered]");let i;const n=r.length;i=s===n?e:l.replace(/{displayCount}/g,s),i=i.replace(/{totalCount}/g,n);const o=document.querySelector("url-router");o&&"object"==typeof o.currentUrlParams&&(i=i.replace(/{(.+)}/g,(function(t,e){return void 0!==o.currentUrlParams[e]?String(o.currentUrlParams[e]):t}))),t.textContent=i}}}window.customElements.define("input-filter",InputFilter,{extends:"input"}),defineExtendsPolyfill("input-filter","input",(t=>{t.hasAttribute("data-polyfill-is-setup")||(t.addEventListener("input",InputFilter.prototype.filter.bind(t)),t.setupFilter=InputFilter.prototype.setupFilter.bind(t),t.getElementsToFilter=InputFilter.prototype.getElementsToFilter.bind(t),t.filter=InputFilter.prototype.filter.bind(t),t.setupFilter(),t.setAttribute("data-polyfill-is-setup",""))}));